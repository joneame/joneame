function update_comments(b){var a=$("#n_comentarios-"+b).html();a++;if(a==false){a=1}$("#n_comentarios-"+b).html(a);if(a==1){$("#t_comentarios-"+b).html(" comentario")}}function setOpacity(a){obj=document.getElementById("ajaxcomments");container=document.getElementById("ajaxcontainer");obj.style.filter="alpha(opacity:"+a+")";obj.style.KHTMLOpacity=a/100;obj.style.MozOpacity=a/100;obj.style.opacity=a/100;container.style.height=(a*obj.offsetHeight/100)+10+"px"}function fadeIn(a){if(a<=100){setOpacity(a);a+=50;window.setTimeout("fadeIn("+a+")",25)}}function startFade(){setOpacity(document.getElementById("ajaxcomments"),0);document.getElementById("ajaxcomments").style.visibility="visible";fadeIn(0)}function submit_comment(){if(document.getElementById("comment").value==""){document.getElementById("error_com").innerHTML="Comentario vacío";document.getElementById("spinner").className="ko";document.getElementById("comment").focus();return false}var b=document.getElementById("comment").value;var h=document.getElementById("process").value;var g=document.getElementById("randkey").value;var e=document.getElementById("link_id").value;var a=document.getElementById("user_id").value;var f=document.getElementById("comentario-admin").checked;var c=document.getElementById("comentario-especial").checked;var d=new XMLHttpRequest();if(d){document.getElementById("submit_com").disabled=true;document.getElementById("comment").disabled=true;document.getElementById("comentario-admin").disabled=true;document.getElementById("comentario-especial").disabled=true;document.getElementById("spinner").className="loading";d.onreadystatechange=function(){if(d.readyState==4){var i=d.responseText;if(String(i).substring(0,3)=="OK:"){document.getElementById("spinner").className="ok";document.getElementById("comment").value="";document.getElementById("ajaxcomments").innerHTML=String(i).substring(3);update_comments(e);startFade();return true}else{document.getElementById("spinner").className="ko";document.getElementById("submit_com").disabled=false;document.getElementById("comment").disabled=false;document.getElementById("comentario-admin").disabled=false;document.getElementById("comentario-especial").disabled=false;document.getElementById("error_com").innerHTML=String(i).substring(3);return false}}};d.open("POST","/ajax/new_comment.php",true);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send("comment_content="+encodeURIComponent(b)+"&process="+h+"&randkey="+g+"&link_id="+e+"&user_id="+a+"&type="+f+"&especial="+c)}}function edit_comment(a){if(document.getElementById("comment_"+a).value==""){document.getElementById("error_com_"+a).innerHTML="Comentario vacío";document.getElementById("spinner_"+a).className="spinner ko";document.getElementById("comment_"+a).focus();return false}var f=document.getElementById("comment_"+a).value;var g=document.getElementById("key_"+a).value;var c=document.getElementById("link_id_"+a).value;var h=document.getElementById("user_id_"+a).value;var i=document.getElementById("comentario-admin_"+a).checked;var b=document.getElementById("comentario-especial_"+a).checked;var d=new XMLHttpRequest();if(d){document.getElementById("submit_com_"+a).disabled=true;document.getElementById("comment_"+a).disabled=true;document.getElementById("comentario-admin_"+a).disabled=true;document.getElementById("comentario-especial_"+a).disabled=true;document.getElementById("spinner_"+a).className="spinner loading";d.onreadystatechange=function(){if(d.readyState==4){var j=d.responseText;if(String(j).substring(0,3)=="OK:"){document.getElementById("spinner_"+a).className="spinner ok";document.getElementById("comment_"+a).value="";document.getElementById("ccontainer-"+a).innerHTML=String(j).substring(3);return true}else{document.getElementById("spinner_"+a).className="spinner ko";document.getElementById("submit_com_"+a).disabled=false;document.getElementById("comment_"+a).disabled=false;document.getElementById("comentario-admin_"+a).disabled=false;document.getElementById("comentario-especial_"+a).disabled=false;document.getElementById("error_com_"+a).innerHTML=String(j).substring(3);return false}}};d.open("POST","/ajax/edit_comment.php?id="+a,true);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send("id="+a+"&comment_content="+encodeURIComponent(f)+"&process=editcomment&key="+g+"&link_id="+c+"&user_id="+h+"&type="+i+"&especial="+b);var e=d.responseText}};